<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>La Esquina - Panel de Control</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="/css/dashboard.css?v=2">
    <link rel="icon" href="/logo.png">
</head>
<body>
    <div id="toast">âœ… AcciÃ³n realizada</div>
    
    <nav class="sidebar">
        <div class="sidebar-header">
            <img src="/logo.png" class="logo-img" alt="La Esquina">
        </div>
        <button class="btn-gasto" onclick="document.getElementById('modal-gasto').style.display='flex'">ğŸ’¸ Registrar Gasto</button>
        <div class="menu">
            <a href="#" class="menu-link active">ğŸ± Control de Mesas</a>
            <a href="/cocina.html" class="menu-link" target="_blank">ğŸ‘¨â€ğŸ³ Pantalla Cocina</a>
            <a href="/inventario.html" class="menu-link">ğŸ“¦ Inventario</a>
            <a href="/reportes.html" class="menu-link">ğŸ“… Historial</a>
            <a href="/cierre_caja.html" class="menu-link">ğŸ”’ Cerrar Caja</a>
        </div>
    </nav>

    <main class="main-content">
        <div class="money-panel">
            <div class="stat-card">
                <div class="stat-title">ğŸ’° VENTAS TOTALES</div>
                <div class="stat-value" id="total-ventas">S/ 0.00</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">ğŸ“‰ GASTOS (SALIDAS)</div>
                <div class="stat-value" id="total-gastos">S/ 0.00</div>
            </div>
            <div class="stat-card card-real" style="border: 1px solid #f1c40f;">
                <div class="stat-title">ğŸ’µ EFECTIVO EN CAJA</div>
                <div class="stat-value" id="total-real" style="color: #f1c40f;">S/ 0.00</div>
            </div>
        </div>
        
        <h2 style="margin-bottom: 20px; color: white;">Mesas y Pedidos</h2>
        <div id="grid-mesas" class="grid-mesas">
            </div>
    </main>

    <div id="modal-gasto" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">ğŸ’¸ Registrar Gasto de Caja</div>
            <div class="modal-body">
                <input type="text" id="gasto-desc" class="modal-input" placeholder="DescripciÃ³n (ej: Compra de Limones)">
                <input type="number" id="gasto-monto" class="modal-input" placeholder="Monto S/" style="margin-top:10px">
            </div>
            <div class="modal-btns">
                <button class="btn-modal btn-cancel" onclick="cerrarModal('modal-gasto')">Cancelar</button>
                <button class="btn-modal btn-confirm" onclick="ejecutarGasto()">Guardar Gasto</button>
            </div>
        </div>
    </div>
    <div id="modal-mover" class="modal-overlay">
        <div class="modal-box" style="max-width: 400px;">
            <div class="modal-title" style="color: var(--gold);">ğŸ”„ Mudanza de Mesa</div>
            <div class="modal-body" style="padding: 20px; text-align: center;">
                <p style="color: var(--text-muted); margin-bottom: 15px; font-weight: 600;">Selecciona la mesa libre de destino:</p>
                <select id="select-mesa-destino" class="modal-input" style="margin-bottom: 20px; text-align: center; font-size: 18px; font-weight: bold;">
                    </select>
            </div>
            <div class="modal-btns">
                <button class="btn-modal btn-cancel" onclick="cerrarModal('modal-mover')">Cancelar</button>
                <button class="btn-modal btn-confirm" onclick="ejecutarMoverMesa()" style="background: var(--gold); color: #000;">TRASLADAR</button>
            </div>
        </div>
    </div>
<div id="modal-pedidos" class="modal-overlay">
        <div class="modal-box" style="max-width: 500px;">
            <div class="modal-title">ğŸº AÃ±adir Consumo</div>
            <div class="modal-body" style="padding: 20px;">
                <input type="text" id="buscador-productos" class="modal-input" placeholder="ğŸ” Buscar cerveza, trago, etc..." onkeyup="filtrarProductosMesa()" style="margin-bottom: 20px;">
                <div id="lista-productos-mesa" style="max-height: 350px; overflow-y: auto; display: grid; gap: 12px; padding-right: 5px;">
                    </div>
            </div>
            <div class="modal-btns">
                <button class="btn-modal btn-cancel" onclick="cerrarModal('modal-pedidos')">Cerrar</button>
            </div>
        </div>
    </div>
    <div id="modal-cobro" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">ğŸ’° Finalizar Cuenta</div>
            <div id="cobro-contenido" class="modal-body">
                </div>
            <div style="padding: 20px; background: #1a1a1a; border-top: 1px solid #333;">
                <div style="display:flex; flex-direction: column; gap: 10px;">
                    <button class="btn-modal" style="background:#27ae60; color:white; padding:15px;" onclick="ejecutarCobroReal('EFECTIVO')">ğŸ’µ EFECTIVO</button>
                    <div style="display:flex; gap:10px;">
                        <button class="btn-modal" style="background:#8e44ad; color:white; flex:1" onclick="ejecutarCobroReal('YAPE')">ğŸŸ£ YAPE / PLIN</button>
                        <button class="btn-modal" style="background:#2980b9; color:white; flex:1" onclick="ejecutarCobroReal('TARJETA')">ğŸ’³ TARJETA</button>
                    </div>
                    <button class="btn-modal" style="background:#f39c12; color:black; font-weight:bold;" onclick="abrirCobroMixto()">âš–ï¸ PAGO MIXTO</button>
                    <button class="btn-modal btn-cancel" onclick="cerrarModal('modal-cobro')">VOLVER</button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-mixto" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title">âš–ï¸ Pago Fraccionado</div>
            <div class="modal-body">
                <p style="color:#aaa;">Total: <strong id="mixto-total" style="color:#2ecc71; font-size:20px;">S/ 0.00</strong></p>
                <div style="margin-top:15px">
                    <label style="font-size:12px; color:#888">ğŸ’µ EFECTIVO</label>
                    <input type="number" id="mixto-efectivo" class="modal-input" placeholder="0.00" oninput="calcularMixto()">
                </div>
                <div style="margin-top:10px">
                    <label style="font-size:12px; color:#888">ğŸ“± DIGITAL (Yape/Otros)</label>
                    <input type="number" id="mixto-digital" class="modal-input" style="background:#222; color:#f1c40f" readonly>
                </div>
            </div>
            <div class="modal-btns">
                <button class="btn-modal btn-cancel" onclick="cerrarModal('modal-mixto'); document.getElementById('modal-cobro').style.display='flex'">AtrÃ¡s</button>
                <button class="btn-modal btn-confirm" onclick="ejecutarCobroReal('MIXTO')">CONFIRMAR</button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    
    <script src="/js/dashboard.js"></script>
</body>
</html>